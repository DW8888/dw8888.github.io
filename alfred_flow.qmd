---
title: "Alfred Architecture"
---

## System Architecture

```{mermaid}
flowchart TD

    subgraph UI["Next.js / React Dashboard"]
        A[Operator Actions]
    end

    subgraph API["FastAPI Backend (Python)"]
        R1[Jobs Router]
        R2[Artifacts & Profiles]
        R3[Search + Persona Resumes]
        R4[GitHub Summaries]
    end

    subgraph Agents["Background Agents"]
        AF[Job Fetcher]
        AM[Job Matcher]
        AR[Resume Agent]
        AC[Cover Letter Agent]
        AG[GitHub Ingestion Agent]
    end

    subgraph Queues["JSON Queues & State Files"]
        Q1[job_fetcher_state.json]
        Q2[state_job_matcher.json]
        Q3[resume_queue.json]
        Q4[cover_letter_queue.json]
        Q5[github_ingestion_state.json]
    end

    subgraph DB["PostgreSQL + pgvector"]
        T1[(jobs)]
        T2[(artifacts)]
        T3[(generated_artifacts)]
    end

    subgraph External["External Services"]
        JAPI[(Job APIs / RSS / Boards)]
        GH[(GitHub Repos)]
        LLM[(OpenAI GPT Models)]
    end

    subgraph Infra["Infrastructure"]
        DKR[docker-compose Postgres]
        AWS[AWS scaffolding (future ECS/RDS)]
    end

    %% UI <-> API (connect to actual nodes, not the subgraph name)
    A -->|HTTP requests| R1
    R1 -->|REST/WebSockets| A

    %% API <-> DB
    R1 --> T1
    R2 --> T2
    R3 --> T3

    %% Job ingestion pipeline
    AF -->|gets jobs| JAPI
    AF --> Q1
    Q1 --> AM
    AM --> Q2
    AM -->|strong matches| Q3
    Q3 --> AR
    AR --> Q4
    Q4 --> AC

    %% Agents write to DB
    AF --> T1
    AM --> T1
    AR --> T3
    AC --> T3

    %% GitHub ingestion
    AG --> GH
    AG --> Q5
    Q5 --> R4
    R4 --> LLM

    %% LLM usage
    AR -->|prompting| LLM
    AC -->|prompting| LLM
    AM -->|LLM skill check| LLM

    %% Infrastructure
    DKR --> T1
    DKR --> T2
    DKR --> T3

    %% Correct dotted-arrow labeling syntax
    AWS -.->|future deploy| R1
    AWS -.->|future deploy| AF
    ```